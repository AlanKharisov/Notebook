<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–ø–∏—Å–∞–Ω–∞ –∫–Ω–∏–≥–∞</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9f9f9;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f4f4f4;
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }

        .header h1 {
            flex-grow: 1;
            text-align: center;
            margin: 0;
        }

        .header button {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
        }

        .main {
            padding: 10px;
        }

        .category {
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
        }

        .category button {
            border: none;
            cursor: pointer;
            font-size: 16px;
            text-align: left;
            width: 100%;
            padding: 10px;
            border-radius: 5px;
        }

        .category button:hover {
            background-color: #e0e0e0;
        }

        .dishes {
            display: none;
            padding-left: 20px;
            gap: 5px;
            margin-top: 10px;
        }

        #add-menu,
        #recipe-menu,
        #search-menu {
            display: none;
        }

        .ingredient-list {
            margin-top: 15px;
        }

        .ingredient-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid #ddd;
        }

        .ingredient-item span {
            flex: 1;
        }

        .ingredient-item button {
            background: none;
            border: none;
            color: red;
            cursor: pointer;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ" –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .add-dish-button {
            background-color: #ddd;
            color: #333;
            font-size: 16px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            text-align: center;
            border: none;
            margin-top: 10px;
            /* –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É */
            margin-bottom: 10px;
            /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
        }

        .add-dish-button:hover {
            background-color: #45a049;
        }

        .edit-icon {
            width: 20px;
            cursor: pointer;
            margin-left: 10px;
        }

        .delete-icon {
            width: 20px;
            cursor: pointer;
            margin: 0 10px;
        }

        .edit-icon1 {
            width: 20px;
            cursor: pointer;
            margin-right: 10px;
        }

        #ingredient-tags span {
            display: inline-block;
            background-color: #e0e0e0;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }

        #ingredient-tags span:hover {
            background-color: #c0c0c0;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–æ–≤ */
        .search-result-item {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }

        .search-result-item h4 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .search-result-item ul {
            list-style-type: none;
            padding: 0;
        }

        .search-result-item ul li {
            margin: 5px 0;
            font-size: 14px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ */
        #registration-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #registration-menu .registration-form {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 400px;
        }

        #registration-menu input {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #registration-menu button {
            background-color: #4CAF50;
            color: white;
            font-size: 16px;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            text-align: center;
            border: none;
        }

        #registration-menu button:hover {
            background-color: #45a049;
        }

        #ingredient-tags span.selected {
            background-color: #4CAF50;
            color: white;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 600px) {
            .header {
                flex-direction: row;
                justify-content: space-between;
            }

            .header h1 {
                text-align: center;
                flex-grow: 1;
            }

            .header button {
                width: auto;
                text-align: center;
                padding: 10px;
            }

            .main {
                padding: 5px;
            }

            .category button {
                font-size: 14px;
                padding: 8px;
            }

            .add-dish-button {
                font-size: 14px;
                padding: 8px;
            }

            .edit-icon,
            .delete-icon,
            .edit-icon1 {
                width: 16px;
            }

            #registration-menu .registration-form {
                width: 95%;
            }

            /* –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–æ–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–¥ –ø–æ–ª–µ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö */
            #ingredient-description {
                display: block;
                margin-top: 10px;
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <button onclick="toggleVisibility('add-menu')">–î–æ–¥–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
        <button id="searchIcon" class="search-icon">üîç</button>
    </div>

    <div id="main-menu" class="main">
        <h3>–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó —Å—Ç—Ä–∞–≤</h3>
        <div id="categories">
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>

    <div id="add-menu" class="main">
        <button onclick="goBack()">‚¨Ö –ù–∞–∑–∞–¥</button>
        <h3>–©–æ —Ö–æ—á–µ—Ç–µ –¥–æ–¥–∞—Ç–∏?</h3>
        <button onclick="addCategory()">–î–æ–¥–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</button>
    </div>

    <div id="category-menu" class="main">
        <h3 id="category-title"></h3>
        <div id="category-dishes">
            <!-- –ë–ª—é–¥–∞ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>

    <div id="recipe-menu" class="main">
        <button onclick="goBack()">‚¨Ö –ù–∞–∑–∞–¥</button>
        <h3 id="recipe-title">–ù–∞–∑–≤–∞ —Å—Ç—Ä–∞–≤–∏</h3>
        <div>
            <input type="text" id="ingredient-name" placeholder="–Ü–Ω–≥—Ä–∏–¥—ñ—î–Ω—Ç">
            <input type="text" id="ingredient-quantity" placeholder="–ö—ñ–ª—å–∫—ñ—Å—Ç—å (–≥—Ä–∞–º–∏, –º–ª —Ç–æ—â–æ)">
            <button onclick="addIngredient()">–î–æ–¥–∞—Ç–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç</button>
            <input type="text" id="ingredient-description" placeholder="–û–ø–∏—Å">
            <button onclick="addDescription()">–î–æ–¥–∞—Ç–∏ –æ–ø–∏—Å</button>
        </div>
        <div id="ingredient-list" class="ingredient-list">
            <!-- –°–ø–∏—Å–æ–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>

    <div id="search-menu" class="main">
        <button onclick="goBack()">‚¨Ö –ù–∞–∑–∞–¥</button>
        <h3>–Ü–Ω–≥—Ä–∏–¥—ñ—î–Ω—Ç–∏:</h3>
        <div id="popular-ingredients">
            <div id="ingredient-tags">
                <!-- –ö–≤–∞–¥—Ä–∞—Ç–∏–∫–∏ —Å –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
            </div>
        </div>
        <div id="only-ingredients" class="recipes-section">
            <h3>–°—Ç—Ä–∞–≤–∏, –≤ —è–∫–∏—Ö —î –ª–∏—à–µ —Ü—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏:</h3>
            <div id="only-ingredients-list"></div> <!-- –°—é–¥–∞ –±—É–¥–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –±–ª—é–¥–∞ -->
        </div>
        <div id="other-ingredients" class="recipes-section">
            <h3>–°—Ç—Ä–∞–≤–∏, –≤ —è–∫–∏—Ö —î –Ω–µ –ª–∏—à–µ —Ü—ñ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏:</h3>
            <div id="other-ingredients-list"></div> <!-- –°—é–¥–∞ –±—É–¥–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –±–ª—é–¥–∞ -->
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å localStorage
        function getFromLocalStorage(key, defaultValue = []) {
            return JSON.parse(localStorage.getItem(key)) || defaultValue;
        }

        const searchPopup = document.getElementById("search-popup");


        function saveToLocalStorage(key, value) {
            localStorage.setItem(key, JSON.stringify(value));
        }

        // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
        function normalizeIngredient(ingredient) {
            return ingredient.replace(/[\d.,]+\s*\w*\s*/g, '').trim().toLowerCase();
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        function editCategory(index) {
            const newName = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –Ω–∞–∑–≤—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó:', categories[index].name);
            if (newName) {
                categories[index].name = newName;
                saveToLocalStorage('categories', categories);
                renderCategories();
            }
        }

        function addCategory() {
            const categoryName = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó:');
            if (categoryName) {
                categories.push({ name: categoryName, dishes: [] });
                saveToLocalStorage('categories', categories);
                renderCategories();
            }
        }

        function addDishToCategory(index) {
            const dishName = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Å—Ç—Ä–∞–≤–∏:');
            if (dishName) {
                console.log(`–î–æ–¥–∞–≤–∞–Ω–Ω—è —Å—Ç—Ä–∞–≤–∏: ${dishName} –≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é ${categories[index].name}`);
                if (!categories[index].dishes) {
                    categories[index].dishes = [];
                }
                categories[index].dishes.push(dishName);
                saveToLocalStorage('categories', categories);
                renderDishes(index);
            }
        }

        function renderCategories() {
            const categoriesContainer = document.getElementById('categories');
            categoriesContainer.innerHTML = '';

            categories.forEach((category, index) => {
                const categoryElement = document.createElement('div');
                categoryElement.className = 'category';
                categoryElement.innerHTML = `
            <div style="display: flex; align-items: center;">
                <button onclick="toggleDishes(${index})" style="flex-grow: 1;">${category.name}</button>
                <img src="img/–ö–∞—Ä–∞–Ω–¥–∞—à.png" class="edit-icon1" onclick="editCategory(${index})" alt="Edit">
                <img src="img/–ö—Ä–µ—Å—Ç–∏–∫.png" class="delete-icon" onclick="deleteCategory(${index})" alt="Delete">
            </div>
            <div class="dishes" id="dishes-${index}" style="display:none;"></div>
        `;
                categoriesContainer.appendChild(categoryElement);
            });
        }

        function deleteCategory(index) {
            if (confirm('–í–∏ –¥—ñ–π—Å–Ω–æ –±–∞–∂–∞—î—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –∫–∞—Ç–µ–≥–æ—Ä—ñ—é?')) {
                categories.splice(index, 1);
                saveToLocalStorage('categories', categories);
                renderCategories();
            }
        }

        function renderDishes(index) {
            const dishesContainer = document.getElementById(`dishes-${index}`);
            const category = categories[index];

            dishesContainer.innerHTML = `
        <button class="add-dish-button" onclick="addDishToCategory(${index})">–î–æ–¥–∞—Ç–∏ —Å—Ç—Ä–∞–≤—É</button>
    `;

            if (category.dishes.length === 0) {
                dishesContainer.innerHTML += '<p>–ù–µ–º–∞—î —Å—Ç—Ä–∞–≤ —É —Ü—ñ–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</p>';
                return;
            }

            category.dishes.forEach((dish, dishIndex) => {
                const dishElement = document.createElement('div');
                dishElement.className = 'dish';
                dishElement.innerHTML = `
            <div style="display: flex; align-items: center;">
                <button onclick="openRecipe('${dish}')" style="flex-grow: 1;">${dish}</button>
                <img src="img/–ö–∞—Ä–∞–Ω–¥–∞—à.png" class="edit-icon" onclick="editDish(${index}, ${dishIndex})" alt="Edit">
                <img src="img/–ö—Ä–µ—Å—Ç–∏–∫.png" class="delete-icon" onclick="deleteDish(${index}, ${dishIndex})" alt="Delete">
            </div>
        `;
                dishesContainer.appendChild(dishElement);
            });
        }

        function deleteDish(categoryIndex, dishIndex) {
            if (confirm('–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é —Å—Ç—Ä–∞–≤—É?')) {
                categories[categoryIndex].dishes.splice(dishIndex, 1);
                saveToLocalStorage('categories', categories);
                renderDishes(categoryIndex);
            }
        }

        function toggleDishes(index) {
            const dishesContainer = document.getElementById(`dishes-${index}`);
            dishesContainer.style.display = dishesContainer.style.display === 'none' ? 'block' : 'none';
            renderDishes(index);
        }

        function editDish(categoryIndex, dishIndex) {
            const newDishName = prompt(
                '–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –Ω–∞–∑–≤—É —Å—Ç—Ä–∞–≤–∏:',
                categories[categoryIndex].dishes[dishIndex]
            );
            if (newDishName) {
                categories[categoryIndex].dishes[dishIndex] = newDishName;
                saveToLocalStorage('categories', categories);
                renderDishes(categoryIndex);
            }
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞–º–∏
        function openRecipe(dishName) {
            currentDish = dishName;
            document.getElementById('recipe-title').textContent = dishName;
            toggleVisibility('recipe-menu');
            loadRecipeIngredients();
        }

        let currentDescription = '';

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
        function addIngredient() {
            const name = document.getElementById('ingredient-name').value.trim();
            const quantity = document.getElementById('ingredient-quantity').value.trim();

            if (!name || !quantity) return alert('–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è!');

            let currentRecipe = recipes.find(recipe => recipe.name === currentDish);
            if (!currentRecipe) {
                currentRecipe = { name: currentDish, ingredients: [] };
                recipes.push(currentRecipe);
            }

            currentRecipe.ingredients.push({ name, quantity, description: currentDescription });
            saveToLocalStorage('recipes', recipes); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ—Ü–µ–ø—Ç—ã –≤ localStorage
            loadRecipeIngredients();
            addPopularIngredient(name); // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç –≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ

            // –°–±—Ä–æ—Å —Ç–µ–∫—É—â–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
            currentDescription = '';
            document.getElementById('ingredient-name').value = '';
            document.getElementById('ingredient-quantity').value = '';
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è
        function addDescription() {
            const description = document.getElementById('ingredient-description').value.trim();
            if (!description) return alert('–í–≤–µ–¥—ñ—Ç—å –æ–ø–∏—Å!');

            let currentRecipe = recipes.find(recipe => recipe.name === currentDish);
            if (!currentRecipe) {
                return alert('–°–ø–æ—á–∞—Ç–∫—É –¥–æ–¥–∞–π—Ç–µ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç!');
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–º—É –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—É
            const lastIngredient = currentRecipe.ingredients[currentRecipe.ingredients.length - 1];
            lastIngredient.description = description;
            saveToLocalStorage('recipes', recipes); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ—Ü–µ–ø—Ç—ã –≤ localStorage
            loadRecipeIngredients();

            // –°–±—Ä–æ—Å —Ç–µ–∫—É—â–µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
            document.getElementById('ingredient-description').value = '';
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ —Ä–µ—Ü–µ–ø—Ç–∞
        function loadRecipeIngredients() {
            const currentRecipe = recipes.find(recipe => recipe.name === currentDish);
            const ingredientsList = document.getElementById('ingredient-list');

            if (currentRecipe) {
                ingredientsList.innerHTML = currentRecipe.ingredients
                    .map((ingredient, index) => `
                <div style="display: flex; align-items: center;">
                    <span style="flex-grow: 1;">${ingredient.name}: ${ingredient.quantity}</span>
                    <img src="img/–ö–∞—Ä–∞–Ω–¥–∞—à.png" class="edit-icon" onclick="editIngredient(${index})" alt="Edit">
                    <img src="img/–ö—Ä–µ—Å—Ç–∏–∫.png" class="delete-icon" onclick="deleteIngredient(${index})" alt="Delete">
                </div>
                ${ingredient.description ? `<div style="padding-left: 20px;">${ingredient.description}</div>` : ''}
            `)
                    .join('');
            } else {
                ingredientsList.innerHTML = '<p>–†–µ—Ü–µ–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∏–π.</p>';
            }
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
        function editIngredient(index) {
            const currentRecipe = recipes.find(recipe => recipe.name === currentDish);
            const newIngredientName = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –Ω–∞–∑–≤—É —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∞:', currentRecipe.ingredients[index].name);
            const newIngredientQuantity = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∞:', currentRecipe.ingredients[index].quantity);
            const newIngredientDescription = prompt('–í–≤–µ–¥—ñ—Ç—å –Ω–æ–≤–∏–π –æ–ø–∏—Å —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∞:', currentRecipe.ingredients[index].description);

            if (newIngredientName && newIngredientQuantity) {
                currentRecipe.ingredients[index] = { name: newIngredientName, quantity: newIngredientQuantity, description: newIngredientDescription };
                saveToLocalStorage('recipes', recipes); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ localStorage
                loadRecipeIngredients();
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞
        function deleteIngredient(index) {
            const currentRecipe = recipes.find(recipe => recipe.name === currentDish);
            if (confirm('–í–∏ –¥—ñ–π—Å–Ω–æ —Ö–æ—á–µ—Ç–µ, —â–æ–± –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç?')) {
                currentRecipe.ingredients.splice(index, 1);
                saveToLocalStorage('recipes', recipes); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ localStorage
                loadRecipeIngredients();
            }
        }

        function removeIngredient(name) {
            const currentRecipe = recipes.find(recipe => recipe.name === currentDish);
            if (currentRecipe) {
                currentRecipe.ingredients = currentRecipe.ingredients.filter(ingredient => ingredient.name !== name);
                saveToLocalStorage('recipes', recipes);
                loadRecipeIngredients();
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–¥–µ–ª–æ–≤
        function toggleVisibility(targetId) {
            const sections = ['main-menu', 'add-menu', 'category-menu', 'recipe-menu', 'search-menu', 'registration-menu'];
            sections.forEach(sectionId => {
                const section = document.getElementById(sectionId);
                if (section) {
                    section.style.display = sectionId === targetId ? 'block' : 'none';
                    console.log(`Section ${sectionId} display: ${section.style.display}`); // –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                }
            });
        }

        let categories = getFromLocalStorage('categories', [
            { name: '–ü–µ—Ä—à–µ', dishes: [] },
            { name: '–î—Ä—É–≥–µ', dishes: [] },
            { name: '–¢—Ä–µ—Ç—î', dishes: [] },
            { name: '–°–º–∞–∫–æ–ª–∏–∫–∏', dishes: [] }
        ]);
        let recipes = getFromLocalStorage('recipes', []);
        let currentDish = null;

        document.addEventListener('DOMContentLoaded', () => {
            renderCategories();
            toggleVisibility('main-menu');
        });

        // –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞–∑–∞–¥
        function goBack() {
            document.getElementById('add-menu').style.display = 'none';
            document.getElementById('category-menu').style.display = 'none';
            document.getElementById('recipe-menu').style.display = 'none';
            document.getElementById('search-menu').style.display = 'none';
            document.getElementById('main-menu').style.display = 'block';
        }

        document.addEventListener("DOMContentLoaded", function () {
            const searchMenu = document.getElementById("search-menu");

            searchIcon.addEventListener("click", () => {
                searchPopup.classList.toggle("hidden");
            });

            document.addEventListener('DOMContentLoaded', () => {
                const element = document.querySelector('#yourElementId');
                if (element) {
                    element.addEventListener('click', () => {
                        // –≤–∞—à –∫–æ–¥
                    });
                }
            });


            document.addEventListener("DOMContentLoaded", function () {
                // –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ–∏—Å–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
                searchMenu = document.getElementById("search-menu");
            });
        });

        // –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è –º–µ–Ω—é –ø–æ–∏—Å–∫–∞
        let searchMenu;

        function toggleSearchMenu() {
            toggleVisibility('search-menu');
        }

        let selectedIngredients = [];

        function addPopularIngredient(ingredient) {
            const ingredientTags = document.getElementById('ingredient-tags');

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ
            const existingIngredient = Array.from(ingredientTags.children).find(
                tag => tag.textContent.trim().toLowerCase() === ingredient.trim().toLowerCase()
            );

            if (existingIngredient) return; // –ï—Å–ª–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–µ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ —Å–Ω–æ–≤–∞

            const ingredientElement = document.createElement('span');
            ingredientElement.textContent = ingredient;
            ingredientElement.onclick = () => toggleIngredientSelection(ingredientElement, ingredient);
            ingredientTags.appendChild(ingredientElement);

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ –≤ localStorage
            let popularIngredients = getFromLocalStorage('popularIngredients', []);
            if (!popularIngredients.includes(ingredient)) {
                popularIngredients.push(ingredient);
                saveToLocalStorage('popularIngredients', popularIngredients);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const popularIngredients = getFromLocalStorage('popularIngredients', []);
            popularIngredients.forEach(addPopularIngredient);
            renderCategories();
            toggleVisibility('main-menu');
        });

        function toggleIngredientSelection(element, ingredient) {
            const index = selectedIngredients.indexOf(ingredient);
            if (index > -1) {
                selectedIngredients.splice(index, 1);
                element.classList.remove('selected');
            } else {
                selectedIngredients.push(ingredient);
                element.classList.add('selected');
            }
            searchRecipes(); // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
        }

        // –ü—Ä–∏–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', () => {
            popularIngredients.forEach(addPopularIngredient);
        });

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
        function renderSelectedIngredients() {
            const selectedIngredientsList = document.getElementById('selected-ingredients-list');
            selectedIngredientsList.innerHTML = selectedIngredients.length
                ? selectedIngredients.map(ingredient => `<div>${ingredient}</div>`).join('')
                : '<p>–Ü–Ω–≥—Ä–∏–¥—ñ—î–Ω—Ç–∏ –Ω–µ –æ–±—Ä–∞–Ω—ñ</p>';
        }

        function searchRecipes() {
            const normalizedIngredients = selectedIngredients.map(normalizeIngredient);

            const onlyIngredientsResults = recipes.filter(recipe =>
                normalizedIngredients.every(ingredient =>
                    recipe.ingredients.some(({ name }) => normalizeIngredient(name).includes(ingredient))
                ) && recipe.ingredients.length === normalizedIngredients.length
            );

            const otherIngredientsResults = recipes.filter(recipe =>
                normalizedIngredients.every(ingredient =>
                    recipe.ingredients.some(({ name }) => normalizeIngredient(name).includes(ingredient))
                ) && recipe.ingredients.length > normalizedIngredients.length
            );

            renderSearchResults(onlyIngredientsResults, 'only-ingredients-list');
            renderSearchResults(otherIngredientsResults, 'other-ingredients-list');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞
        function renderSearchResults(results, containerId) {
            const resultsContainer = document.getElementById(containerId);
            resultsContainer.innerHTML = results.length
                ? results.map(recipe => `<div>${recipe.name}</div>`).join('')
                : '<p>–†–µ—Ü–µ–ø—Ç–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω—ñ</p>';
        }
        // –ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—É
        function searchByIngredient(ingredient) {
            const normalizedIngredient = normalizeIngredient(ingredient);
            const onlyIngredientsResults = recipes.filter(recipe =>
                recipe.ingredients.length === 1 && normalizeIngredient(recipe.ingredients[0].name) === normalizedIngredient
            );
            const otherIngredientsResults = recipes.filter(recipe =>
                recipe.ingredients.some(({ name }) => normalizeIngredient(name) === normalizedIngredient) &&
                recipe.ingredients.length > 1
            );

            renderSearchResults(onlyIngredientsResults, 'only-ingredients-list');
            renderSearchResults(otherIngredientsResults, 'other-ingredients-list');
        }

        function getFromLocalStorage(key, defaultValue = []) {
            const value = localStorage.getItem(key);
            return value ? JSON.parse(value) : defaultValue;
        }

        function saveToLocalStorage(key, value) {
            localStorage.setItem(key, JSON.stringify(value));
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –∑–Ω–∞—á–∫—É –ª—É–ø—ã
        const searchIcon = document.getElementById("searchIcon");
        if (searchIcon) {
            searchIcon.addEventListener("click", toggleSearchMenu);
        } else {
            console.error("Element with ID 'searchIcon' not found!");
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏
        window.toggleSearchMenu = toggleSearchMenu;
    </script>
